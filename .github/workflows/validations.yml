name: Validations

on:
  pull_request:
    branches:
      - main

jobs:
  type-check:
    runs-on: ubuntu-latest
    
    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # 1. Configurar Node.js (SIN CACHÃ‰ AQUÃ)
      - name: ğŸ”§ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          # Â¡QUITAR EL 'cache: pnpm' de aquÃ­! Esto forzaba el error.

      # 2. âœ… CONFIGURACIÃ“N Y CACHÃ‰ DE PNPM (La forma correcta)
      # Este paso instala la CLI de pnpm y configura la cachÃ© de pnpm.
      - name: ğŸ› ï¸ Setup pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 10.19.0 
          # Configurar la cachÃ© dentro de esta acciÃ³n.
          run_install: true # Cambiamos a 'true' para que gestione la instalaciÃ³n de una vez.
          # Nota: TambiÃ©n podrÃ­as dejar 'run_install: false' y mantener el paso pnpm install.
          
      # 3. ğŸ“¦ (Opcional si usaste run_install: true) Install dependencies
      # Si dejaste 'run_install: true' arriba, este paso puede ser redundante o
      # puedes usarlo para asegurar que Turborepo funcione correctamente. 
      # Lo mantendremos para mayor seguridad y compatibilidad con Turborepo.
      - name: ğŸ“¦ Install dependencies (pnpm)
        run: pnpm install

      - name: ğŸ” Run 'check-types' (Turborepo)
        run: pnpm run check-types